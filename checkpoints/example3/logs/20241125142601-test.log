2024-11-25 14:26:01
device: cuda:2
{
  "train_file": "datasets/example_datasets3/train_dataset.csv",
  "val_file": "",
  "multilabel": true,
  "kfold": false,
  "fold_splits": 5,
  "validation_rate": 0.15,
  "test_file": "datasets/example_datasets3/test_dataset.csv",
  "token_level": "char",
  "stop_words": false,
  "stop_words_file": "datasets/example_datasets2/stop_words.txt",
  "remove_special": true,
  "token_file": "datasets/example_datasets3/char-token2id",
  "classes": [
    "组织关系-辞/离职",
    "司法行为-拘捕",
    "人生-死亡",
    "人生-庆生",
    "竞赛行为-退役",
    "灾害/意外-洪灾",
    "组织关系-停职",
    "组织关系-解散",
    "财经/交易-加息",
    "司法行为-立案",
    "人生-失联",
    "组织行为-开幕",
    "组织行为-闭幕",
    "产品行为-召回",
    "司法行为-约谈",
    "竞赛行为-禁赛",
    "灾害/意外-地震",
    "灾害/意外-坠机",
    "组织关系-解雇",
    "司法行为-开庭",
    "司法行为-起诉",
    "交往-点赞",
    "产品行为-获奖",
    "组织关系-解约",
    "财经/交易-出售/收购",
    "产品行为-上映",
    "司法行为-罚款",
    "组织关系-退出",
    "交往-会见",
    "财经/交易-降息",
    "财经/交易-跌停",
    "人生-离婚",
    "财经/交易-上市",
    "交往-感谢",
    "灾害/意外-车祸",
    "产品行为-下架",
    "人生-怀孕",
    "人生-求婚",
    "组织行为-游行",
    "组织关系-裁员",
    "司法行为-举报",
    "财经/交易-涨停",
    "财经/交易-融资",
    "竞赛行为-晋级",
    "灾害/意外-袭击",
    "产品行为-发布",
    "财经/交易-涨价",
    "交往-道歉",
    "竞赛行为-胜负",
    "人生-结婚",
    "人生-婚礼",
    "灾害/意外-坍/垮塌",
    "竞赛行为-退赛",
    "交往-探班",
    "组织关系-加盟",
    "竞赛行为-夺冠",
    "财经/交易-降价",
    "人生-出轨",
    "组织行为-罢工",
    "灾害/意外-爆炸",
    "人生-订婚",
    "司法行为-入狱",
    "人生-产子/女",
    "灾害/意外-起火",
    "人生-分手"
  ],
  "checkpoints_dir": "checkpoints/example3",
  "max_sequence_length": 100,
  "dropout_rate": 0.5,
  "metrics_average": "samples",
  "use_multilabel_categorical_cross_entropy": true,
  "use_focal_loss": false,
  "weight": null,
  "use_poly_loss": false,
  "use_label_smoothing": true,
  "smooth_factor": 0.1,
  "use_gan": true,
  "gan_method": "fgm",
  "attack_round": 3,
  "use_r_drop": false,
  "multisample_dropout": true,
  "dropout_round": 5,
  "seed": 3407,
  "noisy_tune": false,
  "noise_lambda": 0.12,
  "warmup": true,
  "scheduler_type": "linear",
  "num_warmup_steps": -1,
  "swa": false,
  "swa_start_step": 5000,
  "swa_lr": 1e-06,
  "anneal_epochs": 1,
  "ema": true,
  "optimizer": "AdamW",
  "init_network": false,
  "init_network_method": "xavier",
  "use_fp16": false,
  "f_model_type": "Bert",
  "ptm": "bert-base-chinese",
  "f_epoch": 30,
  "f_batch_size": 32,
  "f_learning_rate": 4e-05,
  "f_print_per_batch": 50,
  "f_is_early_stop": true,
  "f_patient": 3,
  "f_model_name": "torch.bin",
  "s_model_type": "TextCNN",
  "embedding_dim": 300,
  "num_filters": 64,
  "hidden_dim": 1024,
  "use_attention": false,
  "encoder_num": 1,
  "head_num": 4,
  "s_epoch": 100,
  "s_batch_size": 32,
  "s_learning_rate": 0.001,
  "s_print_per_batch": 50,
  "s_is_early_stop": true,
  "s_patient": 8,
  "s_model_name": "torch.bin"
}
{
  "self_distillation": true,
  "distillation_method": "ce",
  "teacher_model_type": "Bert",
  "student_model_type": "Bert",
  "checkpoints_dir": "checkpoints/student",
  "epoch": 100,
  "batch_size": 32,
  "learning_rate": 0.0001,
  "print_per_batch": 50,
  "is_early_stop": true,
  "patient": 2,
  "alpha": 0.1,
  "temperature": 4,
  "student_model_name": "distillation_model.pkl",
  "teacher_model_name": "finetune_bert_pgd.pkl",
  "distill_mlm_config": {
    "attention_probs_dropout_prob": 0.1,
    "hidden_act": "gelu",
    "hidden_dropout_prob": 0.1,
    "hidden_size": 768,
    "initializer_range": 0.02,
    "intermediate_size": 3072,
    "max_position_embeddings": 512,
    "num_attention_heads": 12,
    "num_hidden_layers": 3,
    "type_vocab_size": 2,
    "vocab_size": 21128
  },
  "intermediate_matches": [
    {
      "layer_T": 0,
      "layer_S": 0,
      "feature": "hidden",
      "loss": "hidden_mse",
      "weight": 1
    },
    {
      "layer_T": 8,
      "layer_S": 2,
      "feature": "hidden",
      "loss": "hidden_mse",
      "weight": 1
    }
  ]
}
mode: test
stage: finetune
test time consumption: 3905.673(ms)

global result:
precision: 0.918 recall: 0.931 f1: 0.918 accuracy: 0.863 
