2024-11-25 10:21:48
device: cuda
{
  "train_file": "datasets/example_datasets1/train_dataset.csv",
  "val_file": "datasets/example_datasets1/val_dataset.csv",
  "multilabel": false,
  "kfold": false,
  "fold_splits": 4,
  "validation_rate": 0.15,
  "test_file": "",
  "token_level": "char",
  "stop_words": false,
  "stop_words_file": "datasets/example_datasets1/stop_words.txt",
  "remove_special": true,
  "token_file": "datasets/example_datasets1/char-token2id",
  "classes": [
    "negative",
    "positive"
  ],
  "checkpoints_dir": "checkpoints/example1",
  "max_sequence_length": 50,
  "dropout_rate": 0.5,
  "seed": 3407,
  "noisy_tune": false,
  "metrics_average": "binary",
  "use_focal_loss": true,
  "weight": null,
  "use_poly_loss": false,
  "use_label_smoothing": false,
  "smooth_factor": 0.1,
  "use_gan": true,
  "gan_method": "pgd",
  "attack_round": 3,
  "use_r_drop": false,
  "multisample_dropout": true,
  "dropout_round": 5,
  "warmup": true,
  "scheduler_type": "linear",
  "num_warmup_steps": -1,
  "swa": false,
  "swa_start_step": 5000,
  "swa_lr": 1e-06,
  "anneal_epochs": 1,
  "ema": false,
  "optimizer": "AdamW",
  "init_network": false,
  "init_network_method": "xavier",
  "use_fp16": false,
  "f_model_type": "Bert",
  "ptm": "bert-base-chinese",
  "f_epoch": 30,
  "f_batch_size": 16,
  "f_learning_rate": 4e-05,
  "f_print_per_batch": 50,
  "f_is_early_stop": true,
  "f_patient": 3,
  "f_model_name": "torch.bin",
  "s_model_type": "TextCNN",
  "embedding_dim": 300,
  "num_filters": 64,
  "hidden_dim": 2048,
  "use_attention": false,
  "encoder_num": 1,
  "head_num": 12,
  "s_epoch": 100,
  "s_batch_size": 16,
  "s_learning_rate": 0.001,
  "s_print_per_batch": 50,
  "s_is_early_stop": true,
  "s_patient": 8,
  "s_model_name": "torch.bin"
}
stage: train
Initializing from scratch.
train dataset nums:8522
validation dataset nums:1477
++++++++++++++++++++training starting++++++++++++++++++++

epoch:1/100
training batch:    50, loss: 0.32937, precision: 0.000 recall: 0.000 f1: 0.000 accuracy: 0.312 
training batch:   100, loss: 0.23203, precision: 0.750 recall: 0.600 f1: 0.667 accuracy: 0.625 
training batch:   150, loss: 0.16082, precision: 0.600 recall: 0.857 f1: 0.706 accuracy: 0.688 
training batch:   200, loss: 0.13067, precision: 0.667 recall: 0.750 f1: 0.706 accuracy: 0.688 
training batch:   250, loss: 0.09373, precision: 0.818 recall: 0.900 f1: 0.857 accuracy: 0.812 
training batch:   300, loss: 0.06996, precision: 0.889 recall: 1.000 f1: 0.941 accuracy: 0.938 
training batch:   350, loss: 0.26659, precision: 0.800 recall: 0.500 f1: 0.615 accuracy: 0.688 
training batch:   400, loss: 0.11353, precision: 1.000 recall: 0.846 f1: 0.917 accuracy: 0.875 
training batch:   450, loss: 0.14692, precision: 0.875 recall: 0.778 f1: 0.824 accuracy: 0.812 
training batch:   500, loss: 0.13065, precision: 0.889 recall: 1.000 f1: 0.941 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9178082191780822, 'recall': 0.9305555555555556, 'f1-score': 0.9241379310344828, 'support': 720.0}
positive: {'precision': 0.9330655957161981, 'recall': 0.9207397622192867, 'f1-score': 0.9268617021276596, 'support': 757.0}

loss: 0.062 precision: 0.933 recall: 0.921 f1: 0.927 accuracy: 0.926 
time consumption:0.23(min)
saved the new best model with f1: 0.927

epoch:2/100
training batch:    50, loss: 0.05087, precision: 0.857 recall: 0.857 f1: 0.857 accuracy: 0.875 
training batch:   100, loss: 0.10505, precision: 0.714 recall: 1.000 f1: 0.833 accuracy: 0.875 
training batch:   150, loss: 0.15975, precision: 1.000 recall: 0.750 f1: 0.857 accuracy: 0.812 
training batch:   200, loss: 0.06037, precision: 0.900 recall: 0.900 f1: 0.900 accuracy: 0.875 
training batch:   250, loss: 0.06725, precision: 0.800 recall: 1.000 f1: 0.889 accuracy: 0.938 
training batch:   300, loss: 0.04960, precision: 1.000 recall: 0.714 f1: 0.833 accuracy: 0.875 
training batch:   350, loss: 0.01688, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.07225, precision: 0.818 recall: 0.900 f1: 0.857 accuracy: 0.812 
training batch:   450, loss: 0.02832, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
training batch:   500, loss: 0.09153, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9297520661157025, 'recall': 0.9375, 'f1-score': 0.9336099585062242, 'support': 720.0}
positive: {'precision': 0.9400798934753661, 'recall': 0.9326287978863936, 'f1-score': 0.9363395225464192, 'support': 757.0}

loss: 0.051 precision: 0.940 recall: 0.933 f1: 0.936 accuracy: 0.935 
time consumption:0.16(min)
saved the new best model with f1: 0.936

epoch:3/100
training batch:    50, loss: 0.07245, precision: 1.000 recall: 0.800 f1: 0.889 accuracy: 0.875 
training batch:   100, loss: 0.03530, precision: 1.000 recall: 0.889 f1: 0.941 accuracy: 0.938 
training batch:   150, loss: 0.02771, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   200, loss: 0.01933, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   250, loss: 0.08491, precision: 0.889 recall: 0.800 f1: 0.842 accuracy: 0.812 
training batch:   300, loss: 0.02159, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   350, loss: 0.05916, precision: 0.857 recall: 0.750 f1: 0.800 accuracy: 0.812 
training batch:   400, loss: 0.05288, precision: 1.000 recall: 0.889 f1: 0.941 accuracy: 0.938 
training batch:   450, loss: 0.15549, precision: 0.833 recall: 0.714 f1: 0.769 accuracy: 0.812 
training batch:   500, loss: 0.07006, precision: 1.000 recall: 0.923 f1: 0.960 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9077922077922078, 'recall': 0.9708333333333333, 'f1-score': 0.938255033557047, 'support': 720.0}
positive: {'precision': 0.9702970297029703, 'recall': 0.9062087186261559, 'f1-score': 0.9371584699453552, 'support': 757.0}

loss: 0.056 precision: 0.970 recall: 0.906 f1: 0.937 accuracy: 0.938 
time consumption:0.16(min)
saved the new best model with f1: 0.937

epoch:4/100
training batch:    50, loss: 0.03453, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   100, loss: 0.01597, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   150, loss: 0.00802, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   200, loss: 0.03579, precision: 1.000 recall: 0.917 f1: 0.957 accuracy: 0.938 
training batch:   250, loss: 0.04374, precision: 1.000 recall: 0.833 f1: 0.909 accuracy: 0.938 
training batch:   300, loss: 0.04610, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
training batch:   350, loss: 0.00918, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.07503, precision: 0.833 recall: 0.833 f1: 0.833 accuracy: 0.875 
training batch:   450, loss: 0.04836, precision: 0.917 recall: 1.000 f1: 0.957 accuracy: 0.938 
training batch:   500, loss: 0.02307, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
start evaluate engines...
negative: {'precision': 0.9483960948396095, 'recall': 0.9444444444444444, 'f1-score': 0.9464161447459987, 'support': 720.0}
positive: {'precision': 0.9473684210526315, 'recall': 0.9511228533685601, 'f1-score': 0.949241924851681, 'support': 757.0}

loss: 0.048 precision: 0.947 recall: 0.951 f1: 0.949 accuracy: 0.948 
time consumption:0.16(min)
saved the new best model with f1: 0.949

epoch:5/100
training batch:    50, loss: 0.03988, precision: 0.750 recall: 1.000 f1: 0.857 accuracy: 0.875 
training batch:   100, loss: 0.08738, precision: 0.714 recall: 1.000 f1: 0.833 accuracy: 0.875 
training batch:   150, loss: 0.11774, precision: 0.833 recall: 1.000 f1: 0.909 accuracy: 0.938 
training batch:   200, loss: 0.01564, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   250, loss: 0.00998, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.00881, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   350, loss: 0.01774, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.11540, precision: 0.889 recall: 0.889 f1: 0.889 accuracy: 0.875 
training batch:   450, loss: 0.01294, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   500, loss: 0.05649, precision: 0.909 recall: 1.000 f1: 0.952 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9431345353675451, 'recall': 0.9444444444444444, 'f1-score': 0.9437890353920888, 'support': 720.0}
positive: {'precision': 0.9470899470899471, 'recall': 0.9458388375165125, 'f1-score': 0.9464639788499669, 'support': 757.0}

loss: 0.050 precision: 0.947 recall: 0.946 f1: 0.946 accuracy: 0.945 
time consumption:0.16(min)

epoch:6/100
training batch:    50, loss: 0.02692, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   100, loss: 0.03445, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
training batch:   150, loss: 0.02154, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   200, loss: 0.02897, precision: 0.900 recall: 1.000 f1: 0.947 accuracy: 0.938 
training batch:   250, loss: 0.01062, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.03498, precision: 0.833 recall: 1.000 f1: 0.909 accuracy: 0.938 
training batch:   350, loss: 0.00500, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.21348, precision: 0.667 recall: 1.000 f1: 0.800 accuracy: 0.875 
training batch:   450, loss: 0.03442, precision: 1.000 recall: 0.750 f1: 0.857 accuracy: 0.875 
training batch:   500, loss: 0.00427, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
start evaluate engines...
negative: {'precision': 0.929945054945055, 'recall': 0.9402777777777778, 'f1-score': 0.9350828729281767, 'support': 720.0}
positive: {'precision': 0.9425901201602136, 'recall': 0.9326287978863936, 'f1-score': 0.9375830013280212, 'support': 757.0}

loss: 0.061 precision: 0.943 recall: 0.933 f1: 0.938 accuracy: 0.936 
time consumption:0.16(min)

epoch:7/100
training batch:    50, loss: 0.00511, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   100, loss: 0.00378, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   150, loss: 0.02475, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   200, loss: 0.00128, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   250, loss: 0.00973, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.01322, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   350, loss: 0.06609, precision: 0.800 recall: 1.000 f1: 0.889 accuracy: 0.938 
training batch:   400, loss: 0.00083, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   450, loss: 0.01156, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   500, loss: 0.00642, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
start evaluate engines...
negative: {'precision': 0.9319727891156463, 'recall': 0.9513888888888888, 'f1-score': 0.9415807560137457, 'support': 720.0}
positive: {'precision': 0.9528301886792453, 'recall': 0.9339498018494056, 'f1-score': 0.9432955303535692, 'support': 757.0}

loss: 0.061 precision: 0.953 recall: 0.934 f1: 0.943 accuracy: 0.942 
time consumption:0.16(min)

epoch:8/100
training batch:    50, loss: 0.01307, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
training batch:   100, loss: 0.13533, precision: 0.833 recall: 0.833 f1: 0.833 accuracy: 0.875 
training batch:   150, loss: 0.00937, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   200, loss: 0.07970, precision: 0.909 recall: 1.000 f1: 0.952 accuracy: 0.938 
training batch:   250, loss: 0.00343, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.00766, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   350, loss: 0.06719, precision: 1.000 recall: 0.909 f1: 0.952 accuracy: 0.938 
training batch:   400, loss: 0.01765, precision: 1.000 recall: 0.857 f1: 0.923 accuracy: 0.938 
training batch:   450, loss: 0.00465, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   500, loss: 0.03124, precision: 1.000 recall: 0.875 f1: 0.933 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9586410635155096, 'recall': 0.9013888888888889, 'f1-score': 0.9291338582677166, 'support': 720.0}
positive: {'precision': 0.91125, 'recall': 0.9630118890356671, 'f1-score': 0.9364161849710984, 'support': 757.0}

loss: 0.060 precision: 0.911 recall: 0.963 f1: 0.936 accuracy: 0.933 
time consumption:0.16(min)

epoch:9/100
training batch:    50, loss: 0.02603, precision: 0.833 recall: 1.000 f1: 0.909 accuracy: 0.938 
training batch:   100, loss: 0.00227, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   150, loss: 0.01390, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   200, loss: 0.03135, precision: 1.000 recall: 0.833 f1: 0.909 accuracy: 0.938 
training batch:   250, loss: 0.00196, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.01321, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   350, loss: 0.03587, precision: 1.000 recall: 0.857 f1: 0.923 accuracy: 0.938 
training batch:   400, loss: 0.06558, precision: 0.909 recall: 1.000 f1: 0.952 accuracy: 0.938 
training batch:   450, loss: 0.13590, precision: 0.846 recall: 1.000 f1: 0.917 accuracy: 0.875 
training batch:   500, loss: 0.01444, precision: 0.900 recall: 1.000 f1: 0.947 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.9661266568483063, 'recall': 0.9111111111111111, 'f1-score': 0.9378127233738385, 'support': 720.0}
positive: {'precision': 0.9197994987468672, 'recall': 0.9696169088507266, 'f1-score': 0.9440514469453377, 'support': 757.0}

loss: 0.074 precision: 0.920 recall: 0.970 f1: 0.944 accuracy: 0.941 
time consumption:0.16(min)

epoch:10/100
training batch:    50, loss: 0.02659, precision: 0.875 recall: 1.000 f1: 0.933 accuracy: 0.938 
training batch:   100, loss: 0.00546, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   150, loss: 0.04638, precision: 0.875 recall: 1.000 f1: 0.933 accuracy: 0.938 
training batch:   200, loss: 0.01757, precision: 0.833 recall: 1.000 f1: 0.909 accuracy: 0.938 
training batch:   250, loss: 0.02069, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   300, loss: 0.01712, precision: 1.000 recall: 0.889 f1: 0.941 accuracy: 0.938 
training batch:   350, loss: 0.12105, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   400, loss: 0.00024, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   450, loss: 0.01145, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   500, loss: 0.02015, precision: 1.000 recall: 0.889 f1: 0.941 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.8965071151358344, 'recall': 0.9625, 'f1-score': 0.9283322170127262, 'support': 720.0}
positive: {'precision': 0.9616477272727273, 'recall': 0.8943196829590488, 'f1-score': 0.9267624914442163, 'support': 757.0}

loss: 0.083 precision: 0.962 recall: 0.894 f1: 0.927 accuracy: 0.928 
time consumption:0.17(min)

epoch:11/100
training batch:    50, loss: 0.00688, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   100, loss: 0.00590, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   150, loss: 0.04348, precision: 0.857 recall: 1.000 f1: 0.923 accuracy: 0.938 
training batch:   200, loss: 0.00238, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   250, loss: 0.06696, precision: 0.889 recall: 1.000 f1: 0.941 accuracy: 0.938 
training batch:   300, loss: 0.00478, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   350, loss: 0.00325, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.00843, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   450, loss: 0.21720, precision: 0.889 recall: 0.889 f1: 0.889 accuracy: 0.875 
training batch:   500, loss: 0.04105, precision: 0.889 recall: 1.000 f1: 0.941 accuracy: 0.938 
start evaluate engines...
negative: {'precision': 0.895618556701031, 'recall': 0.9652777777777778, 'f1-score': 0.929144385026738, 'support': 720.0}
positive: {'precision': 0.9643366619115549, 'recall': 0.892998678996037, 'f1-score': 0.9272976680384087, 'support': 757.0}

loss: 0.080 precision: 0.964 recall: 0.893 f1: 0.927 accuracy: 0.928 
time consumption:0.16(min)

epoch:12/100
training batch:    50, loss: 0.00745, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   100, loss: 0.05288, precision: 1.000 recall: 0.900 f1: 0.947 accuracy: 0.938 
training batch:   150, loss: 0.01523, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   200, loss: 0.41652, precision: 0.857 recall: 0.857 f1: 0.857 accuracy: 0.875 
training batch:   250, loss: 0.03119, precision: 1.000 recall: 0.818 f1: 0.900 accuracy: 0.875 
training batch:   300, loss: 0.01364, precision: 0.900 recall: 1.000 f1: 0.947 accuracy: 0.938 
training batch:   350, loss: 0.01527, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   400, loss: 0.04529, precision: 0.900 recall: 1.000 f1: 0.947 accuracy: 0.938 
training batch:   450, loss: 0.00211, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
training batch:   500, loss: 0.00039, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
start evaluate engines...
negative: {'precision': 0.962852897473997, 'recall': 0.9, 'f1-score': 0.9303661162957646, 'support': 720.0}
positive: {'precision': 0.9104477611940298, 'recall': 0.9669749009247027, 'f1-score': 0.9378603459320949, 'support': 757.0}

loss: 0.078 precision: 0.910 recall: 0.967 f1: 0.938 accuracy: 0.934 
time consumption:0.16(min)
early stopped, no progress obtained within 8 epochs
overall best f1 is 0.949241924851681 at 4 epoch
total training time consumption: 2.028(min)
